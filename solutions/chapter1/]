; If the number is too small, maybe even smaller than the
; given initial guess, then the procedure `good-enough?`
; can never work properly because the initial guess is good
; enough in this situation. On the other hand, if the number
; is too large, then the difference between the number and
; the guess will be ignored by accuracy.

(define accuracy 0.0001)

(define (better-sqrt x)

  (define (better-sqrt-iter guess)
    (if (good-enough? guess)
      guess
      (improve guess)))

  (define (good-enough? guess)
    (< (abs (- guess x)) accuracy))

  (define (improve guess)
    (average guess (/ x guess)))

  (define (square x) (* x x))

  (define (average x y)
    (/ (+ x y) 2)))
